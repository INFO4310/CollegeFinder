<html>

<head>
    <script src="https://d3js.org/d3.v5.min.js"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js"
        integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo"
        crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"
        integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1"
        crossorigin="anonymous"></script>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css"
        integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"
        integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM"
        crossorigin="anonymous"></script>
    <style>
        .accordion {
            width: 50%;
            max-width: 500px;
        }
    </style>
</head>

<body>
    <!-- more information can be found here: https://getbootstrap.com/docs/4.3/components/collapse/ -->
    <div class="accordion" id="collegeQuiz">

        <!-- Start card for Location -->
        <div class="card">
            <div class="card-header" id="headingOne">
                <h2 class="mb-0">
                    <button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapseOne"
                        aria-expanded="true" aria-controls="collapseOne">
                        Location
                    </button>
                </h2>
            </div>

            <div id="collapseOne" class="collapse show" aria-labelledby="headingOne" data-parent="#collegeQuiz">
                <div class="card-body" id="location-card">
                    <label for="states">Choose a state:</label>

                    <!-- Arielle: needs to be changed for multiple states! -->
                    <select name="states" id="states" onclick=loadCollegeMap()>
                        <option value="all states">All States</option>
                        <option value="alabama">Alabama</option>
                        <option value="alaska">Alaska</option>
                        <option value="arizona">Arizona</option>
                        <option value="arkansas">Arkansas</option>
                        <option value="california">California</option>
                        <option value="colorado">Colorado</option>
                        <option value="connecticut">Connecticut</option>
                        <option value="delaware">Delaware</option>
                        <option value="florida">Florida</option>
                        <option value="georgia">Georgia</option>
                        <option value="hawaii">Hawaii</option>
                        <option value="idaho">Idaho</option>
                        <option value="illinois">Illinois</option>
                        <option value="indiana">Indiana</option>
                        <option value="iowa">Iowa</option>
                        <option value="kansas">Kansas</option>
                        <option value="kentucky">Kentucky</option>
                        <option value="louisiana">Louisiana</option>
                        <option value="maine">Maine</option>
                        <option value="maryland">Maryland</option>
                        <option value="massachusetts">Massachusetts</option>
                        <option value="michigan">Michigan</option>
                        <option value="minnesota">Minnesota</option>
                        <option value="mississippi">Mississippi</option>
                        <option value="missouri">Missouri</option>
                        <option value="montana">Montana</option>
                        <option value="nebraska">Nebraska</option>
                        <option value="hevada">Nevada</option>
                        <option value="new hampshire">New Hamshire</option>
                        <option value="new jersey">New Jersey</option>
                        <option value="new mexico">New Mexico</option>
                        <option value="new york">New York</option>
                        <option value="north carolina">North Carolina</option>
                        <option value="north dakota">North Dakota</option>
                        <option value="ohio">Ohio</option>
                        <option value="oklahoma">Oklahoma</option>
                        <option value="oregon">Oregon</option>
                        <option value="pennsylvania">Pennsylvania</option>
                        <option value="rhode Island">Rhode Island</option>
                        <option value="south Carolina">South Carolina</option>
                        <option value="south Dakota">South Dakota</option>
                        <option value="tennessee">Tennessee</option>
                        <option value="texas">Texas</option>
                        <option value="utah">Utah</option>
                        <option value="vermont">Vermont</option>
                        <option value="virginia">Virginia</option>
                        <option value="washington">Washington</option>
                        <option value="west virginia">West Virginia</option>
                        <option value="wisconsin">Wisconsin</option>
                        <option value="wyoming">Wyoming</option>

                    </select>
                    <!-- <input type="checkbox"></input> -->
                </div>
            </div>
        </div>
        <!-- End card for Location -->

        <!-- Start card for Tuition -->
        <div class="card">
            <div class="card-header" id="headingTwo">
                <h2 class="mb-0">
                    <button class="btn btn-link collapsed" type="button" data-toggle="collapse"
                        data-target="#collapseTwo" aria-expanded="false" aria-controls="collapseTwo">
                        Tuition
                    </button>
                </h2>
            </div>
            <div id="collapseTwo" class="collapse" aria-labelledby="headingTwo" data-parent="#collegeQuiz">
                <div class="card-body">
                    <label for="tuition">Tuition (between $0 and $100,000):&nbsp</label><label for="tuition"
                        id="tuitionNumber">$50,000</label></br>
                    <input type="range" id="tuition" name="tuition" min="0" max="100000" onclick=loadCollegeMap()></br>
                </div>
            </div>
        </div>
        <!-- End card for Tuition -->

        <!-- Start card for Size -->
        <div class="card">
            <div class="card-header" id="headingThree">
                <h2 class="mb-0">
                    <button class="btn btn-link collapsed" type="button" data-toggle="collapse"
                        data-target="#collapseThree" aria-expanded="false" aria-controls="collapseThree">
                        Size
                    </button>
                </h2>
            </div>
            <div id="collapseThree" class="collapse" aria-labelledby="headingThree" data-parent="#collegeQuiz">
                <div class="card-body">
                    <p>Choose a size:</p>
                    <input type="checkbox" id="size1" class="size" name="size" value="100" onclick=loadCollegeMap()>
                    <label for="size1">0 - 100 students</label><br>
                    <input type="checkbox" id="size2" class="size" name="size" value="1000" onclick=loadCollegeMap()>
                    <label for="size2">100 - 1,000 students</label><br>
                    <input type="checkbox" id="size3" class="size" name="size" value="10000" onclick=loadCollegeMap()>
                    <label for="size3">1,000 - 10,000 students</label><br>
                    <input type="checkbox" id="size4" class="size" name="size" value="50000" onclick=loadCollegeMap()>
                    <label for="size4">10,000 - 50,000 students</label><br>
                    <input type="checkbox" id="size5" class="size" name="size" value="100000" onclick=loadCollegeMap()>
                    <label for="size5">50,000 - 100,000 students</label><br>

                    <br>
                    <!-- <input type="submit" value="Submit"> -->
                </div>
            </div>
        </div>
        <!-- End card for Size -->

        <!-- Start card for Test Scores -->
        <div class="card">
            <div class="card-header" id="headingFour">
                <h2 class="mb-0">
                    <button class="btn btn-link collapsed" type="button" data-toggle="collapse"
                        data-target="#collapseFour" aria-expanded="true" aria-controls="collapseFour">
                        Test Scores
                    </button>
                </h2>
            </div>
            <div id="collapseFour" class="collapse" aria-labelledby="headingFour" data-parent="#collegeQuiz">
                <div class="card-body">
                    <input type="checkbox" id="SAT_score" name="SAT_score">
                    <label for="SAT_score">SAT</label></br>
                    <label for="SAT_score_points">Score (between 0 and 1600):&nbsp</label><label for="SAT_score_points"
                        id="SATNumber">0</label></br>
                    <input type="range" id="SAT_score_points" name="SAT_score_points" min="0" max="1600"
                        onchange=loadCollegeMap()></br>
                    <input type="checkbox" id="ACT_score" name="ACT_score">
                    <label for="ACT_score">ACT</label></br>
                    <label for="ACT_score_points">Score (between 0 and 36):&nbsp</label><label for="ACT_score_points"
                        id="ACTNumber">0</label></br>
                    <input type="range" id="ACT_score_points" name="ACT_score_points" min="0" max="36"
                        onchange=loadCollegeMap()></br>
                </div>
            </div>
        </div>
    </div>
    <!-- End card for Test Scores -->

    <script>
        ////////////////////////////data manipulation/////////////////////////
        const loadCollegeMap = async () => {

            // const data = await d3.csv('MERGED2018_19_PP.csv');

            // var newData = data.map((d) => {
            //     return {
            //         name: d.INSTNM,
            //         lat: d.LATITUDE,
            //         lon: d.LONGITUDE,
            //         state: d.STABBR,
            //         tuition: Number(d.COSTT4_A),
            //         SAT: Number(d.SAT_AVG),
            //         ACT: Number(d.ACTCMMID),
            //         //admissions: d.ADM_RATE,
            //         size: d.UGDS
            //     };
            // });


            // // console.log(newData);
            // console.log(JSON.stringify(newData))

            //////////////////////////////calling filtered data ////////////////////////

            //load data
            const AllData = await d3.json('filteredCollegeData.json');

            //get states
            var state = d3.select('#states').property("value");
            //TO DO: need to change this to a forEach loop
            //TO DO: get state
            // newData = AllData.filter((d) => {
            //     return (d.state = state)
            // })

            //get tuition
            var tuition = d3.select('#tuition').property("value")
            d3.select('#tuitionNumber').text("$" + formatNumber(tuition))

            //get sizes
            var sizes = [];
            var checkedSize = d3.selectAll("input.size:checked")._groups[0];
            checkedSize.forEach((d) => {
                sizes.push(Number(d.value))
            });

            //get test scores
            var SATVal = d3.select('#SAT_score_points').property("value")
            d3.select('#SATNumber').text(SATVal)
            var ACTVal = d3.select('#ACT_score_points').property("value")
            d3.select('#ACTNumber').text(ACTVal)

            console.log(state, tuition, sizes, SATVal, ACTVal)

            //call UpdateData

            UpdateData(AllData, state, tuition, sizes, SATVal, ACTVal)
        }

        //helper functions!
        function UpdateData(AllData) {
            var newData = {};
            console.log("updating data")


            drawCircles(newData)
        }

        //present number with comma
        function formatNumber(num) {
            format = d3.format(",");
            return (format(num))
        }



        function drawCircles() {
            //Jennifer's code
        }
            //update(allData, false);
            // d3.select("#btn").on("click", event=>{
            //   let filterDataset = allData.filter(d=>{
            //     return (d.Country === "us"); 
            //   })
            //   update(filterDataset, true); 
            // });
            // d3.select("#All").on("click", event=>{
            //   update(allData, true); 
            // }); 
            // d3.select("#US").on("click", event=>{
            //   let filterDataset = allData.filter(d=>{
            //     return (d.Country === "us"); 
            //   })
            //   update(filterDataset, true); 
            // });
            // d3.select("#GB").on("click", event=>{
            //   let filterDataset = allData.filter(d=>{
            //     return (d.Country === "gb"); 
            //   })
            //   update(filterDataset, true); 
            // });
            // d3.select("#DE").on("click", event=>{
            //   let filterDataset = allData.filter(d=>{
            //     return (d.Country === "de"); 
            //   })
            //   update(filterDataset, true); 
            // });
            // d3.select("#AU").on("click", event=>{
            //   let filterDataset = allData.filter(d=>{
            //     return (d.Country === "au"); 
            //   })
            //   update(filterDataset, true); 
            // });
            // d3.select("#CA").on("click", event=>{
            //   let filterDataset = allData.filter(d=>{
            //     return (d.Country === "ca"); 
            //   })
            //   update(filterDataset, true); 
            // });






            //End Arielle's Code
    </script>
</body>

</html>